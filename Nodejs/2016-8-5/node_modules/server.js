/**
 * 模块依赖
 */
var count = 0
	, usres = {}
	,nickname = '';

var net = require('net');
/**
 * 创建服务器
 */

var server = net.createServer(function (conn) {
	//handle connection
	conn.write(
		'\n > welcome to \033[92mnode-chat\033[39m!'
		+ '\n >' + count + ' other people are connected at this time.'
		+ '\n > please write your name and press enter:'
		);
	conn.setEncoding('utf8');
	count ++;
	conn.on('data', function (data) {

		// 删除回车符
		data = data.replace('\r\n', '');
		console.log(data);
	});
	conn.on('close', function () {
		count --;
	});
})

/**
 * 监听
 */
server.listen(3000, function () {
	console.log('\033[96m server listening on *:3000\033[39m');
})