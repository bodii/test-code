<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Strict mode 严格模式</title>
</head>
<body>
	<script>
		'use strict';

		/**
		 * ECMAScript 5的严格模式是JavaScript中的一种限制性更强的变种方式。严格模式不是一个子集；
		 * 它在语义上正常代码有着明显的差异。不支持严格模式的浏览器与支持严格模式的浏览器行为上也不
		 * 一样，所以不要在未经严格模式特性测试情况下使用严格模式。严格模式可以与非严格模式共存，所
		 * 以脚本可以逐渐的选择加入严格模式。
		 */
		

		// example 1
		//mistypedVaraible = 17; // 假如有一个全局变量叫做mistypedVartiable
		//  Uncaught ReferenceError: mistypedVaraible is not defined (chrome)
		//  ReferenceError: assignment to undeclared variable mistypedVaraible (firefox)
		 
		// example 2
			// 给不可写属性赋值
			//var obj1 = {};
			//Object.defineProperty(obj1, 'x', { value: 42, writalbe: false});
			//obj1.x = 9; // 抛出TypeError错误
			//Uncaught TypeError: Cannot assign to read only property 'x' of object '#<Object>'(chrome)
			//TypeError: "x" is read-only(firefox)
			
		// example 3
			// 给只读属性赋值
			//var obj2 = { get x() { return 17;} };
			//obj2.x = 5; 
			// Uncaught TypeError: Cannot set property x of #<Object> which has only a getter(chrome)
			// TypeError: setting a property that has only a getter(firefox)
			
		// example 4
			// 给不可扩展对象的新属性赋值
			//var fixed = {};
			//Object.preventExtensions(fixed);
			// Object.preventExtensions() 方法让一个对象变的不可扩展，也就是永远不能再添加新的属性。
			//fixed.newProp = 'ohai';
			//Uncaught TypeError: Can't add property newProp, object is not extensible(chrome)
			//TypeError: can't define property "newProp": Object is not extensible(firefox)
		
		// 第三，在严格模式下，试图删除不可删除的属性时会抛出异常（之前这种操作不会产生任何效果）
		// example 5
		//delete Object.prototype;
		//Uncaught TypeError: Cannot delete property 'prototype' of function Object() { [native code] } (chrome)
		//TypeError: property "prototype" is non-configurable and can't be deleted(firefox)
		

		// 第四， 在Gecko(firefox)版本34之前， 严格模式要求一个对象内的所有属性名在对象内必须唯一。
		//正常模式下重名属性是允许的，最后一个重名的属性决定其属性值。因为只有最后一个属性起作用，当
		//代码是要改变属性值而却不是修改的最后一个重名属性的时候， 复制这个对象就产生一连串的bug.在
		//严格模式下，重名属性被认为是语法错误
		
		var o = { p: 1, p: 2}; //在ECMAScript6中已经不复存在语法错误


		// 第五，严格模式要求函数的参数名唯一。
		// 在正常模式下，最后一个重名参数名会掩盖之前的重名参数，之前的参数仍然可以通过 arguments[i]
		// 来访问，还不是完全无法访问。然而，这种隐藏毫无意义而且可能是意料之外的（比如它可能本来是打
		// 错了），所认在严格模式下重名参数被认为是语法错误
		
		//function sum (a, a, c) {
		//	return a + b + c;
		//}
		//2016-7-27strict.html:68 Uncaught SyntaxError: Duplicate parameter name not allowed in this context(chrome)
		//SyntaxError: duplicate formal argument a(firefox)
		

		//第六，严格模式禁止八进制数字语法。ECMAScript并不包含八进制语法，但所有的浏览器都支
		//持这种以零（0）开头的八制语法：0644 === 420 还有 "\045" ==="%"有些新手开发者认为
		//数字的前导零没有语法意义，所以他们会用作对齐措施 -- 但其实这会改变数字的意义！八进
		//制语法很少有用并且可能会错误使用，所以严格模式下八进制语法会引起语法错误
		
		//var sum = 015 + 
		//		  197 +
		//		  142;
		//Uncaught SyntaxError: Octal literals are not allowed in strict mode.(chrome)
		//SyntaxError: "0"-prefixed octal literals and octal escape sequences are deprecated; for octal literals use the "0o" prefix instead(firefox)
		
		function strict1 (str) {
			'use strict';
			return eval(str); // str 中的代码在严格模式下运行
		}

		function strict2 (f, str) {
			'use strict';
			return f(str); // 没有直接调用eval():而且仅当str 中的代码开启了严格模
			//才会在严格模式下运行

		}

		function nonostrict(str) {
			return eval(str);
		}

		strict1("'strict mode code!'");
		strict("'use strict'; 'strict mode code!'");
		strict2(eval, "'non-strict code.'");
		strict2(eval, "'use strict'; 'strict mode code!'");
	</script>
</body>
</html>