<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>原型污染</title>
</head>
<body>
	<script type="text/javascript">
		'use strict'
		Object.prototype.properties = function () {
			var result = [];
			for (var property in this)
				result.push(property);
			return result;
		};

		var test = {x: 10, y: 3};
		var res = test.properties();
		console.log(res);


		Object.prototype.properties2 = function () {
			var result = [];
			for (var property in this){
				if (this.hasOwnProperty(property))
					result.push(property);
			}
			return result;
		};

		var test2 = {'Fat Igor': true, 'Fireball': true};
		var res2 = test2.properties2();
		console.log(res2);

		// 高阶函数
		function forEachIn (object, action) {
			for (var property in object) {
				if (object.hasOwnProperty(property))
					action(property, object[property])
			}
		}
		Object.prototype.properies3 = function () {
			var arr = {};
			function action (key, val) {
				arr[key] = val;
			}
			forEachIn(this, action);
			return arr;
		}
		var test3 = {k1: 'v1', k2: 'v2'};
		var res3 = test3.properies3();
		console.log(res3);


		//但是有一个是“hasOwnProperty”
		function forEachIn4 (object, action) {
			for (let property in object) {
				if(Object.prototype.hasOwnProperty.call(object, property))
					action(property, object[property]);
			}
		}
		Object.prototype.properies4 = function () {
			var arr = {};
			function action (key, val) {
				arr[key] = val;
			}
			forEachIn4(this, action);
			return arr;
		}
		var test4 = {k1:'v1', k2: 'v2', hasOwnProperty:'v3'};
		var res4 = test4.properies4();
		console.log(res4);

	</script>	
</body>
</html>